---
docs/2-virtual-machines-containers/2.3-managing-infrastructure.md:
  category: Virtualization
  estReadingMinutes: 10
  exercises:
    -
      name: Artifactory on VMs
      description: Create a VM from your golden image and install and configure Artifactory and deploy an artifact to that VM from a GitHub Action
      estMinutes: 390
      technologies:
      - Vagrant
      - CentOS
      - GitHub Actions
      - Artifactory
---

# Managing Infrastructure

In this section, you will be learning how to deploy your golden image (and other artifacts) to a centralized location from your build pipeline.

## Artifactory

  [Artifactory](https://jfrog.com/artifactory/install/) is a versioned artifact repository. It is used to store multiple versions of different packages and supports different repository types (Maven, npm, Docker, etc). It is scalable and integrates with lots of other software delivery tools.

?> Artifactory is not free, but does have a 14 day [free trial](https://jfrog.com/start-free/) you can use. You will want to select the Self-Hosted option.

## Delivery Pipeline

![A Jenkins pipeline showing passing build, test, and deploy stages](img2/delivery-pipeline-stages_light.svg ':class=light-mode-img-center')
![A Jenkins pipeline showing passing build, test, and deploy stages](img2/delivery-pipeline-stages_dark.svg ':class=dark-mode-img-center')

  Automated delivery pipelines accelerate software delivery and enable faster, safer deployments.
  An entire integrated toolchain is necessary to leverage the capabilities of an automated pipeline, orchestrated by a build server. Newly committed code that is pushed to the git server will trigger a webhook and cause the build servers to run certain tasks. General stages of a delivery pipeline include:

- Unit testing
- Code quality scanning
- Building artifacts (compiling, packaging, containerizing, etc)
- Publishing artifacts to an artifact repository
- Functional testing
- Deploying artifacts

### Exercise

Configure a self-hosted GitHub Action to deploy a build artifact to Artifactory.

  1. Create another clone of your Golden Image
  2. Install [Artifactory](https://jfrog.com/artifactory/install/) into this clone
      - Make sure to select Maven as the repository option during setup.
  3. In GitHub, fork the [spring-petclinic](https://github.com/spring-projects/spring-petclinic) project.
  4. In the GitHub portal, add a new self-hosted runner to your fork.
  5. Create another clone of your Golden Image
  6. Set up this clone as your self-hosted runner in the GitHub portal
  7. Install any dependencies this image needs to be able to build the spring-petclinic project
  8. Alter the maven-build GitHub Action Workflow to use your self-hosted runner
  9. Add a `upload` step to your workflow that uploads the build output to your Artifactory server.
  10. Commit your changes to the fork and verify that your workflow completed successfully.
  11. Open the admin panel for your Artifactory server and verify that you see new artifacts have been uploaded.

### Extra Credit

Working as a group, configure your `upload` step in your workflow to deploy to someone else's Artifactory server using what you have learned about virtual networks.

?> If you are working on different networks you may need to use a tool like [Ngrok](https://ngrok.com/) to bridge communication between your servers over the internet.

# Deliverables

|**Engineers**|**Consultants**|
|-------------|---------------|
| Experience using virtual machines to deploy software delivery tools | Research what Virtual Machines are and how they would be used at an Enterprise |
| Understand the basics of a software delivery pipeline | Create a short slide deck explaining your findings |
| **Discuss:** After completing this exercise how would you improve the process to provision the Jenkins and Artifactory VMs? | Don't forget to use the Liatrio Presentations template |
| **Discuss:** How could this software delivery pipeline be improved? |  |
