---
docs/2-virtual-machines-containers/2.3-managing-infrastructure.md:
  category: Virtualization
  estReadingMinutes: 10
  exercises:
    -
      name: Artifactory on VMs
      description: Create a VM from your golden image and install and configure Artifactory and deploy an artifact to that VM from a GitHub Action
      estMinutes: 390
      technologies:
      - Vagrant
      - CentOS
      - GitHub Actions
      - Artifactory
      - Ngrok
---

# Managing Infrastructure

In this section, you will be learning how to deploy your golden image (and other artifacts) to a centralized location from your build pipeline.

## Artifactory

  [Artifactory](https://jfrog.com/artifactory/install/) is a versioned artifact repository. It is used to store multiple versions of different packages and supports different repository types (Maven, npm, Docker, etc). It is scalable and integrates with lots of other software delivery tools.

  ?> Artifactory is not free, but does have a 14 day [free trial](https://jfrog.com/start-free/) you can use. You will want to select the Self-Hosted option.

## Delivery Pipeline

![A Jenkins pipeline showing passing build, test, and deploy stages](img2/delivery-pipeline-stages_light.svg ':class=light-mode-img-center')
![A Jenkins pipeline showing passing build, test, and deploy stages](img2/delivery-pipeline-stages_dark.svg ':class=dark-mode-img-center')

  Automated delivery pipelines accelerate software delivery and enable faster, safer deployments.
  An entire integrated toolchain is necessary to leverage the capabilities of an automated pipeline, orchestrated by a build server. Newly committed code that is pushed to the git server will trigger a webhook and cause the build servers to run certain tasks. General stages of a delivery pipeline include:

- Unit testing
- Code quality scanning
- Building artifacts (compiling, packaging, containerizing, etc)
- Publishing artifacts to an artifact repository
- Functional testing
- Deploying artifacts

### Exercise

Configure a GitHub Action to deploy a build artifact to Artifactory.

  1. Create a clone of your Golden Image from the previous section
  2. Install Artifactory into this clone
      * Make sure to select Maven as the repository option during setup.
  2. Use [Ngrok](https://ngrok.com/) to expose your Artifactory server.
  3. In GitHub, fork the [spring-petclinic](https://github.com/spring-projects/spring-petclinic) project.
  4. Open up the `maven-build` GitHub Action Workflow in the fork.
  6. Add a `upload` task to your workflow that uploads the build output to your Artifactory server.
  7. Commit your changes to the fork and verify that your workflow completed successfully.
  8. Open the admin panel for your Artifactory server and verify that you see new artifacts have been uploaded.

### Extra Credit

Change your GitHub Action Workflow.  Remove your `upload` task instead add tasks to create a `GitHub Release` in your spring-petclinic fork and upload the build artifacts created to that release.

# Deliverables

|**Engineers**|**Consultants**|
|-------------|---------------|
| Experience using virtual machines to deploy software delivery tools | Research what Virtual Machines are and how they would be used at an Enterprise |
| Understand the basics of a software delivery pipeline | Create a short slide deck explaining your findings |
| **Discuss:** After completing this exercise how would you improve the process to provision the Jenkins and Artifactory VMs? | Don't forget to use the Liatrio Presentations template |
| **Discuss:** How could this software delivery pipeline be improved? |  |
